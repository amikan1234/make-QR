<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</title>
<style>
  body {
    font-family: sans-serif;
    background: #f0f0f0;
    margin: 0;
    padding: 20px;
    text-align: center;
  }
  #mobileToggle {
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 1000;
  }
  input, button, select, label {
    font-size: 16px;
    padding: 8px;
    margin: 5px;
  }
  .button-group {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin: 10px 0;
  }
  #qrcode {
    margin: 20px auto;
    display: flex;
    justify-content: center;
  }
  #randomText {
    margin-top: 10px;
    font-size: 18px;
  }
  .mobile-mode body,
  .mobile-mode input,
  .mobile-mode button,
  .mobile-mode select,
  .mobile-mode label {
    font-size: 20px;
  }
  .mobile-mode .button-group {
    flex-direction: column;
    align-items: stretch;
  }
  .mobile-mode #qrcode canvas {
    width: 90vw !important;
    height: 90vw !important;
  }
</style>
</head>
<body>
<button id="mobileToggle">ğŸ“± ãƒ¢ãƒã‚¤ãƒ«åˆ‡æ›¿</button>

<h1>QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</h1>
<input type="text" id="inputText" placeholder="ä»»æ„ã®æ–‡å­—åˆ—ï¼ˆç©ºãªã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«ãªã‚Šã¾ã™ï¼‰" />
<input type="number" id="lengthInput" value="16" min="1" max="100" style="width: 60px;" />
<br />
<label>
  å‰æ™¯è‰²:
  <input type="color" id="foregroundColor" value="#000000" />
  <span id="fgPreview" style="display:inline-block;width:24px;height:24px;vertical-align:middle;border:1px solid #aaa;margin-left:5px;background:#000;"></span>
</label>
<label>
  èƒŒæ™¯è‰²:
  <input type="color" id="backgroundColor" value="#ffffff" />
  <span id="bgPreview" style="display:inline-block;width:24px;height:24px;vertical-align:middle;border:1px solid #aaa;margin-left:5px;background:#fff;"></span>
</label>
<br />
<label>ã‚µã‚¤ã‚º: <input type="range" id="sizeSlider" min="100" max="500" value="300" /></label>
<span id="sizeLabel">300</span> px

<div class="button-group">
  <button id="generateBtn">ç”Ÿæˆ</button>
  <button id="copyBtn">ã‚³ãƒ”ãƒ¼</button>
  <button id="downloadBtn">ä¿å­˜</button>
  <button id="shareBtn">å…±æœ‰</button>
</div>

<div id="qrcode"></div>
<div id="randomText"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
  const fgInput = document.getElementById("foregroundColor");
  const bgInput = document.getElementById("backgroundColor");
  const fgPreview = document.getElementById("fgPreview");
  const bgPreview = document.getElementById("bgPreview");

  fgInput.addEventListener("input", () => {
    fgPreview.style.backgroundColor = fgInput.value;
  });
  bgInput.addEventListener("input", () => {
    bgPreview.style.backgroundColor = bgInput.value;
  });

  document.getElementById("sizeSlider").oninput = (e) => {
    document.getElementById("sizeLabel").textContent = e.target.value;
  };

  function generateRandomString(length) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    return Array.from({ length }, () => chars[Math.floor(Math.random() * chars.length)]).join('');
  }

  function updateQRCode(text) {
    const fg = fgInput.value;
    const bg = bgInput.value;
    const size = parseInt(document.getElementById("sizeSlider").value);

    const qrDiv = document.getElementById("qrcode");
    qrDiv.innerHTML = "";
    new QRCode(qrDiv, {
      text: text,
      width: size,
      height: size,
      colorDark: fg,
      colorLight: bg
    });

    document.getElementById("randomText").textContent = "QRã‚³ãƒ¼ãƒ‰ã®å†…å®¹ï¼š" + text;
    lastText = text;
  }

  let lastText = "";

  document.getElementById("generateBtn").onclick = () => {
    const input = document.getElementById("inputText").value.trim();
    const len = parseInt(document.getElementById("lengthInput").value) || 16;
    const text = input || generateRandomString(len);
    updateQRCode(text);
  };

  document.getElementById("copyBtn").onclick = () => {
    if (lastText) {
      navigator.clipboard.writeText(lastText)
        .then(() => alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"))
        .catch(() => alert("ã‚³ãƒ”ãƒ¼å¤±æ•—"));
    }
  };

  document.getElementById("downloadBtn").onclick = () => {
    const canvas = document.querySelector("#qrcode canvas");
    if (canvas) {
      const link = document.createElement("a");
      link.download = "qrcode.png";
      link.href = canvas.toDataURL("image/png");
      link.click();
    }
  };

  document.getElementById("shareBtn").onclick = () => {
    if (navigator.share && lastText) {
      navigator.share({
        title: "QRã‚³ãƒ¼ãƒ‰å…±æœ‰",
        text: lastText,
        url: location.href
      }).catch(err => console.log("å…±æœ‰å¤±æ•—:", err));
    } else {
      alert("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å…±æœ‰ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚");
    }
  };

  document.getElementById("mobileToggle").onclick = () => {
    document.body.classList.toggle("mobile-mode");
  };

  window.onload = () => {
    // è‡ªå‹•ã‚¹ãƒãƒ›åˆ¤å®š
    if (window.innerWidth <= 500) {
      document.body.classList.add("mobile-mode");
    }
    const len = parseInt(document.getElementById("lengthInput").value) || 16;
    const text = generateRandomString(len);
    updateQRCode(text);
  };
</script>
</body>
</html>

